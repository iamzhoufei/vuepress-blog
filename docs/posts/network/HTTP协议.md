---
title: HTTP协议
---

## GET与POST的区别

### 应用场景

- `GET`： 是一个幂等的请求，一般用于不会在服务器资源造成修改的场景，例如获取信息，请求资源。
- `POST`：不是一个幂等的请求，一般用于会对服务器资源造成影响的场景，例如注册用户，修改信息。

### 是否缓存

- `GET`：浏览器一般会对`GET`请求设置缓存
- `POST`：浏览器不会对`POST`请求设置缓存

### 报文形式

- `GET`：请求内容直接放在URL中，请求体中无内容
- `POST`：请求内容放在请求体中

### 安全性

- `GET`：由于请求的内容直接放在URL中，并且浏览器会保存历史记录，所以并不安全
- `POST`：请求内容不会直接在URL中展示，且没有历史记录，相对于`GET`请求更安全

### 大小限制

- 首先明确一点，在HTTP协议中，并没有对不同请求方式的大小作出限制。
- `GET`：不同的浏览器实现均有不同，Chrome浏览器最长支持8000个字符的页面URL，而IE只支持约2000个字符
- `POST`：理论上没有限制，但是一般服务端会把大小限制在2M以内

### 数据类型

- `GET`：只能传递字符串类型的数据
- `POST`：由于数据存放在请求体中，所以支持的数据类型更多

## 常见的请求头和响应头

### 请求头

- `Accept`：浏览器能够处理的内容类型
- `Accept-Charset`：浏览器能够解析的字符集
- `Accept-Language`：浏览器当前显示的语言
- `Cookie`：当前页面中存储的Cookie
- `Host`：发出请求的页面所在域
- `Refer`：发出请求的页面URL
- `UserAgent`：用户代理信息
- `业务需要的自定义token`

### 响应头

- `cache-control`：缓存控制
- `content-encoding`：内容编码
- `content-type`：表示后面的文档属于什么MIME类型

### 常见的Content Type

- `application/json`：表示序列化后的`JSON字符串`
- `multipart/form-data`：通常用于在表单中上传文件
- `text/xml`：主要用于提交`XML`格式的数据
- `application/x-www-form-unlencoded`

## 状态码304是多好还是少好

- 状态码304的含义：服务器为了提高网站的访问效率，会对当前页面的请求进行缓存。当对同样的页面再次发起请求时，服务器会根据缓存内容判断页面与之前缓存的页面内容是否相同，如果相同则返回状态码304，告知浏览器直接使用缓存的页面内容，不必进行二次加载。

- 需要分场景进行讨论，对于有SEO需求的网页来说，如果搜索引擎蜘蛛在多次事件范围内抓取到的状态码都是304，会使搜索引擎认为网页的更新频率低，导致搜索权重降低。但是对于页面性能来说，适当的缓存可以改善用户体验，提高页面加载速度。

## HTTP1.0与HTTP1.1的区别

### HTTP1.1

- 相对于`HTTP1.0`，`HTTP1.1`默认使用持久连接，即多个HTTP请求会复用同一个TCP连接，减少网络在建立连接时的时间消耗；
- 在请求头中增加了`Host`字段；
- 新增了`PUT`，`OPTION`等请求方法；

### HTTP2

- 相对于`HTTP1.1`，`HTTP2`是一个二进制的协议，并提出了`帧`的概念，这是实现`多路复用`的基础。

## HTTP协议与HTTPS协议的区别

- HTTPS协议需要CA证书
- HTTP是超文本传输协议，内容是通过明文传输的；而HTTPS使用的是更安全的SSL加密传输协议。
- HTTP使用的是80端口，HTTPS使用的是443端口；
- 在使用`Charles`对请求进行抓包时，HTTPS请求需要额外配置证书；

## 输入URL到渲染页面的过程

### 解析URL

- 首先会对输入的URL进行分析，判断使用的传输协议和请求资源的路径。
  - 如果协议/主机名称不合法：就会直接把地址栏中输入的内容传递给搜索引擎
  - 如果协议/主机名称合法：则浏览器检查是否存在非法字符
    - 存在：会将非法字符进行转义，然后进入下一阶段
    - 不存在：直接进入下一阶段

### 缓存判断

- 检查当前请求的资源是否在缓存中
  - 如果资源在缓存中并且没有失效：直接使用缓存
  - 否则：向服务器发出新的请求

### DNS解析

- 将输入的URL转为IP地址
  - 首先会判断本地是否有该域名的IP地址的缓存。有则直接使用，没有的话会向本地的DNS服务器发起请求。
  - 本地的DNS服务器也会先检查本地的缓存，有则直接返回，没有的话会向根域名服务器发起请求。
  - 这样一层一层向上查询，直到获取到对应的IP地址，或者没有该域名对应的IP地址。

### TCP连接的三次握手

- 客户端向服务器发送一个`SYN`请求连接报文段和一个随机序号
- 服务器接收到请求后，向客户端发送一个`SYN ACK`的的报文段，同时也会发送一个随机序号
- 客户端接收到响应之后，向服务器发送一个`ACK`的确认连接的报文段，同时进入建立连接状态
- 服务器收到确认连接的报文段之后，也进入建立连接状态
- 双方连接建立完成，开始传输数据

### HTTPS握手

- 如果使用的是HTTPS协议，在传输数据前还存在一个四次握手的过程。

### 服务器返回数据

- 当页面请求发送到服务器之后，服务器会返回一个html文件作为响应，浏览器端在接收到响应之后，开始对HTML文件进行解析渲染

### 页面渲染

- 浏览器首先根据html文件开始构建`DOM树`
- 根据解析到的CSS文件构建`CSSOM树`
- 如果解析过程中遇到`<script>`标签，会先判断标签中是否包含`defer`或者`async`属性
  - 如果有的话，就延迟加载资源，优先构建`DOM树`和`CSSOM树`
  - 没有的话，暂停树的构建，优先加载资源
- 完成了`DOM树`和`CSSOM树`的构建后，浏览器会将它们合成为最终的`渲染树`
- `渲染树`构建完成后，浏览器会根据`渲染树`进行页面布局
- 布局完成后，浏览器会调用内部的`UI渲染线程`进行页面渲染

### TCP连接的四次挥手

- 当页面中的资源都请求完毕后，TCP连接就会在四次挥手后断开。

## HTTP CODE

### HTTP CODE分类

| 类别 | 原因 | 描述 |
| --- | ---- | --- |
| 1xx | 信息状态码 | 接收的请求正在处理 |
| 2xx | 成功状态码 | 请求正常处理完毕 |
| 3xx | 重定向状态码 | 需要附加操作才能完成请求 |
| 4xx | 客户端错误状态码 | 服务端无法处理请求 |
| 5xx | 服务端错误状态码 | 服务端处理请求出错 |

### 常见的HTTP CODE

- `200` → 表示请求被成功处理

- `301` → 表示永久重定向
- `302` → 表示临时重定向
- `304` → 表示该请求对应的资源在浏览器中有缓存

- `400 Bad Request` → 表示请求报文中存在语法错误
- `401 Unauthorized` → 表示当前请求的资源需要先进行权限认证
- `403 Forbidden` → 表示当前请求的资源被服务器拒绝访问（通常是没有权限）
- `404 Not Found` → 表示服务器上无法找到请求的资源
- `405 Method Not Allowed` → 表示服务器禁止使用当前的请求方法

- `500 Internal Server Error` → 表示服务器在执行请求时发生错误
