---
title: 垃圾回收机制与内存泄漏
---

## 垃圾回收机制与内存泄漏

V8引擎的GC算法使用了分代式垃圾回收机制，将堆内存分成了两个空间 —— `新生代`，`老生代`

### 新生代垃圾回收机制

- 在新生代空间中，堆内存又被分成了两个部分，分别是`From空间`和`To空间`。在这两个空间中，必定有一个是使用中的，另一个是闲置的。
- 新分配的对象会被放在`From空间`中，当`From空间`被占满了后，新生代垃圾回收机制就会启动，算法会自动检查`From空间`中存活的变量，并将它们复制到`To空间`里。
- 在此过程中，如果发现有的变量已经失活，它们就会被销毁。
- 复制完成后，调换`From空间`和`To空间`，GC结束。

### 老生代垃圾回收机制

- 在老生代空间中，主要使用了`标记清除算法`。
- 浏览器会将内存中所有的变量都加上一个标记，然后把那些`在上下文中的变量`和`被上下文中的变量引用的变量`的标记去除，剩下的就是`没有被引用的变量`了。
- 随后回收程序会做一次垃圾清理，并收回它们使用的内存。

## 内存泄漏

- 使用全局变量
- 定时器中的闭包
